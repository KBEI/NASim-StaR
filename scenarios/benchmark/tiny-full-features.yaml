# Tiny scenario with action variants + detection/response/time/honeypots
#
# 3 hosts
# 3 subnets
# 1 os (linux)
# 3 services (ssh, ftp, http)
# 1 process (tomcat)
#
subnets: [1, 1, 1]
topology: [[ 1, 1, 0, 0],
           [ 1, 1, 1, 1],
           [ 0, 1, 1, 1],
           [ 0, 1, 1, 1]]
sensitive_hosts:
  (2, 0): 100
  (3, 0): 100
os:
  - linux
services:
  - ssh
  - ftp
  - http
processes:
  - tomcat
exploits:
  ssh_bruteforce:
    service: ssh
    os: linux
    prob: 0.5
    cost: 3
    access: user
  password_spray:
    service: ssh
    os: linux
    prob: 0.7
    cost: 2
    access: user
  credential_reuse:
    service: ssh
    os: linux
    prob: 0.8
    cost: 1
    access: user
  web_rce:
    service: http
    os: None
    prob: 0.8
    cost: 2
    access: user
  anonymous_write:
    service: ftp
    os: None
    prob: 0.6
    cost: 1
    access: user
privilege_escalation:
  sudo_misconfig:
    process: tomcat
    os: linux
    prob: 0.8
    cost: 1
    access: root
  kernel_privesc:
    process: tomcat
    os: linux
    prob: 0.6
    cost: 2
    access: root
service_scan_cost: 1
os_scan_cost: 1
subnet_scan_cost: 1
process_scan_cost: 1
scan_actions:
  service_scan:
    - name: port_scan
      cost: 1
      prob: 1.0
      duration: 1
    - name: banner_grab
      cost: 1
      prob: 1.0
      duration: 1
    - name: version_probe
      cost: 2
      prob: 1.0
      duration: 2
    - name: web_content_enum
      cost: 2
      prob: 1.0
      duration: 2
  os_scan:
    - name: os_fingerprint
      cost: 1
      prob: 1.0
      duration: 1
  subnet_scan:
    - name: host_discovery
      cost: 1
      prob: 1.0
      duration: 1
  process_scan:
    - name: process_enum
      cost: 2
      prob: 1.0
      duration: 2
    - name: software_enum
      cost: 2
      prob: 1.0
      duration: 2
host_configurations:
  (1, 0):
    os: linux
    services: [ssh, http]
    processes: [tomcat]
    firewall:
      (3, 0): [ssh]
  (2, 0):
    os: linux
    services: [ssh, ftp]
    processes: [tomcat]
    firewall:
      (1, 0): [ssh]
  (3, 0):
    os: linux
    services: [ssh, http]
    processes: [tomcat]
firewall:
  (0, 1): [ssh, http]
  (1, 0): []
  (1, 2): []
  (2, 1): [ssh]
  (1, 3): [ssh, http]
  (3, 1): [ssh, http]
  (2, 3): [ssh, http]
  (3, 2): [ssh, http]
step_limit: 1000

detection:
  enabled: true
  base_prob:
    service_scan: 0.1
    os_scan: 0.08
    subnet_scan: 0.05
    process_scan: 0.12
    exploit: 0.2
    privilege_escalation: 0.15
  cost_stealth_factor: 0.2

response:
  enabled: true
  alert_threshold: 4
  actions:
    - type: increase_monitoring
      factor: 1.3
      duration_steps: 3
    - type: isolate_host
  sensitive_isolated_failure: false

rewards:
  alert_penalty: -1.0
  sensitive_isolated_penalty: -10.0

time:
  enabled: true
  max_time: 150
  action_duration:
    service_scan: 1
    os_scan: 1
    subnet_scan: 1
    process_scan: 2
    exploit: 2
    privilege_escalation: 2
